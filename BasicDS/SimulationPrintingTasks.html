<!DOCTYPE html>


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>Симуляция: Задания на печать &mdash; Problem Solving with Algorithms and Data Structures</title>
    
    <link rel="stylesheet" href="../_static/basic.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="../_static/bootstrap-3.0.0/css/bootstrap.min.css" type="text/css" />
    <link rel="stylesheet" href="../_static/video.css" type="text/css" />
    <link rel="stylesheet" href="../_static/poll.css" type="text/css" />
    <link rel="stylesheet" href="../_static/tabbedstuff.css" type="text/css" />
    <link rel="stylesheet" href="../_static/css/pytutor.css" type="text/css" />
    <link rel="stylesheet" href="../_static/css/basic.css" type="text/css" />
    <link rel="stylesheet" href="../_static/codemirror.css" type="text/css" />
    <link rel="stylesheet" href="../_static/activecode.css" type="text/css" />
    <link rel="stylesheet" href="../_static/parsons.css" type="text/css" />
    <link rel="stylesheet" href="../_static/lib/prettify.css" type="text/css" />
    <link rel="stylesheet" href="../_static/jquery-ui-1.10.3.custom.min.css" type="text/css" />
    <link rel="stylesheet" href="../_static/bootstrap-sphinx.css" type="text/css" />
    <link rel="stylesheet" href="../_static/user-highlights.css" type="text/css" />
    <link rel="stylesheet" href="../_static/runestone-custom-sphinx-bootstrap.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../',
        VERSION:     '3.0',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <script type="text/javascript" src="../_static/poll.js"></script>
    <script type="text/javascript" src="../_static/js/d3.v2.min.js"></script>
    <script type="text/javascript" src="../_static/jquery-migrate-1.2.1.min.js"></script>
    <script type="text/javascript" src="../_static/js/jquery.ba-bbq.min.js"></script>
    <script type="text/javascript" src="../_static/js/jquery.jsPlumb-1.3.10-all-min.js"></script>
    <script type="text/javascript" src="../_static/js/pytutor.js"></script>
    <script type="text/javascript" src="../_static/jquery.highlight.js"></script>
    <script type="text/javascript" src="../_static/bookfuncs.js"></script>
    <script type="text/javascript" src="../_static/codemirror.js"></script>
    <script type="text/javascript" src="../_static/python.js"></script>
    <script type="text/javascript" src="../_static/javascript.js"></script>
    <script type="text/javascript" src="../_static/activecode.js"></script>
    <script type="text/javascript" src="../_static/skulpt.min.js"></script>
    <script type="text/javascript" src="../_static/skulpt-stdlib.js"></script>
    <script type="text/javascript" src="../_static/assess.js"></script>
    <script type="text/javascript" src="../_static/animationbase.js"></script>
    <script type="text/javascript" src="../_static/lib/jquery.min.js"></script>
    <script type="text/javascript" src="../_static/lib/jquery-ui.min.js"></script>
    <script type="text/javascript" src="../_static/lib/prettify.js"></script>
    <script type="text/javascript" src="../_static/lib/underscore-min.js"></script>
    <script type="text/javascript" src="../_static/lib/lis.js"></script>
    <script type="text/javascript" src="../_static/parsons.js"></script>
    <script type="text/javascript" src="../_static/parsons-noconflict.js"></script>
    <script type="text/javascript" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <script type="text/javascript" src="../_static/jquery-ui-1.10.3.custom.min.js"></script>
    <script type="text/javascript" src="../_static/jquery-fix.js"></script>
    <script type="text/javascript" src="../_static/bootstrap-3.0.0/js/bootstrap.min.js"></script>
    <script type="text/javascript" src="../_static/bootstrap-sphinx.js"></script>
    <script type="text/javascript" src="../_static/waypoints.min.js"></script>
    <script type="text/javascript" src="../_static/rangy-core.js"></script>
    <script type="text/javascript" src="../_static/rangy-textrange.js"></script>
    <script type="text/javascript" src="../_static/rangy-cssclassapplier.js"></script>
    <script type="text/javascript" src="../_static/user-highlights.js"></script>
    <script type="text/javascript" src="../_static/jquery.idle-timer.js"></script>
    <script type="text/javascript" src="../_static/processing-1.4.1.min.js"></script>
    <script type="text/javascript" src="../_static/jquery.hotkey.js"></script>
    <link rel="top" title="Problem Solving with Algorithms and Data Structures" href="../index.html" />
    <link rel="next" title="Что такое дек?" href="WhatIsaDeque.html" />
    <link rel="prev" title="Симуляция: Hot Potato" href="SimulationHotPotato.html" />
<meta charset='utf-8'>
<meta http-equiv='X-UA-Compatible' content='IE=edge,chrome=1'>
<meta content='width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0' name='viewport' />
<script type="text/javascript">
  eBookConfig = {};
  eBookConfig.host = 'http://127.0.0.1:8000' ? 'http://127.0.0.1:8000' : 'http://127.0.0.1:8000';
  eBookConfig.app = eBookConfig.host+'/runestone';
  eBookConfig.ajaxURL = eBookConfig.app+'/ajax/';
  eBookConfig.course = 'pythonds';
  eBookConfig.logLevel = 10;
  eBookConfig.loginRequired = false
  eBookConfig.build_info = "2.1.5";
  eBookConfig.isLoggedIn = false;
</script>

<div id="fb-root"></div>
<script>
  (function(d, s, id) {
    var js, fjs = d.getElementsByTagName(s)[0];
    if (d.getElementById(id)) return;
    js = d.createElement(s); js.id = id;
    js.src = "//connect.facebook.net/en_US/all.js#xfbml=1&status=0";
    fjs.parentNode.insertBefore(js, fjs);
  }(document, 'script', 'facebook-jssdk'));
</script>


<script>
var _prum = [['id', '521dfcc4abe53d0749000000'],
             ['mark', 'firstbyte', (new Date()).getTime()]];
(function() {
    var s = document.getElementsByTagName('script')[0]
      , p = document.createElement('script');
    p.async = 'async';
    p.src = '//rum-static.pingdom.net/prum.min.js';
    s.parentNode.insertBefore(p, s);
})();
</script>



  </head>
  <body>


<!-- Begin navbar -->
<div id="navbar" class="navbar navbar-default navbar-fixed-top" role="navigation">

  <div class="container">

    <div class="navbar-header">
      <!-- .btn-navbar is used as the toggle for collapsed navbar content -->
      <button type='button' class='navbar-toggle' data-toggle="collapse" data-target=".navbar-ex1-collapse">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>

      <div>
        <a class="brand-logo" style='background: transparent url("../_static/img/logo_small.png") no-repeat 0px 0px;' href="/runestone/default/user/login">&nbsp; </a>
        <a class="navbar-brand" href="../index.html">Problem Solving with Algorithms and Data Structures</a>
      </div>
    </div>

    <div class="navbar-collapse collapse navbar-ex1-collapse">

      <ul class="nav navbar-nav navbar-right">

        <li class="divider-vertical"></li>

        <!-- social media dropdown -->
        <li class="dropdown">
          <a class="dropdown-toggle" href="#" data-toggle="dropdown">
            <i class="glyphicon glyphicon-share-alt" style="opacity: 0.9"></i>
          </a>
          <ul class="dropdown-menu social-menu">
              <li>
                <div>
                  <b>Runestone in social media:</b>
                </div>
                <a href="https://twitter.com/iRunestone" class="twitter-follow-button" data-show-count="true">Follow @iRunestone</a><script>!function(d,s,id){var js,fjs=d.getElementsByTagName(s)[0],p=/^http:/.test(d.location)?'http':'https';if(!d.getElementById(id)){js=d.createElement(s);js.id=id;js.src=p+'://platform.twitter.com/widgets.js';fjs.parentNode.insertBefore(js,fjs);}}(document, 'script', 'twitter-wjs');</script>
                <div class="fb-like" data-href="https://www.facebook.com/RunestoneInteractive" data-send="false" data-layout="button_count" data-width="300" data-show-faces="false" data-font="arial"></div>
              </li>

              <li class="divider"></li>
              <li>
                <div>
                  <b>Help support us:</b>
                </div>
                <div class="gittip">
                  <iframe style="border:0;"
                    src="https://www.gittip.com/bnmnetp/widget.html"
                    width="48pt" height="22pt" class="gittip-button">
                  </iframe>
                </div>
                <div>
                    <form action="https://www.paypal.com/cgi-bin/webscr" method="post" target="_top">
                  <input type="hidden" name="cmd" value="_s-xclick">
                  <input type="hidden" name="encrypted" value="-----BEGIN PKCS7-----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-----END PKCS7-----
                  ">
                  <input type="image" src="https://www.paypalobjects.com/en_US/i/btn/btn_donate_SM.gif" border="0" name="submit" alt="PayPal - The safer, easier way to pay online!">
                  <img alt="" border="0" src="https://www.paypalobjects.com/en_US/i/scr/pixel.gif" width="1" height="1">
                  </form>

                </div>
              </li>
          </ul>
        </li>
        <!-- end social media dropdown -->

        <li class="divider-vertical"></li>

        <!-- search dropdown -->
        <li class="dropdown">
          <a class="dropdown-toggle" href="#" data-toggle="dropdown">
            <i class="glyphicon glyphicon-search" style='opacity:0.9;'></i>
          </a>
          <ul class='dropdown-menu'>
            
                <li><a href='../index.html'>Table of Contents</a></li>
            
            <li><a href='/runestone/static/pythonds/genindex.html'>Book Index</a></li>
            <li class="divider"></li>
            <li id="scratch_ac_link"><a href="javascript:toggleScratchActivecode()">Scratch ActiveCode</a></li>
            <li class="divider"></li>
            <li style="width: 240px;">
              <form class="navbar-search" style="margin:10px;" action="../search.html" method="get">
                <div class="input-group">
                  <input type="text" class="form-control" name="q" placeholder="Search this book" />
                  <span class="input-group-btn">
                    <button class="btn btn-primary" style="margin:0;" type="submit">
                      <i class="glyphicon glyphicon-search"></i>
                    </button>
                  </span>
                </div><!-- /input-group -->
                <input type="hidden" name="check_keywords" value="yes" />
                <input type="hidden" name="area" value="default" />
              </form>
            </li>
          </ul>
        </li>
        <!-- end search dropdown -->

        <li class="divider-vertical"></li>

        <!-- user account dropdown -->
        <li class="dropdown">
          <a class="dropdown-toggle" href="#" data-toggle="dropdown">
            <i class="glyphicon glyphicon-user" style="opacity:0.9;"></i>
          </a>
          <ul class="dropdown-menu user-menu">
            <li><span class='loggedinuser'></span></li>
            <li class="divider"></li>
            <li><a href='http://127.0.0.1:8000/runestone/admin/index'>Instructor's Page</a></li>
            <li class="divider"></li>
            <li><a href="http://127.0.0.1:8000/runestone/default/user/profile" id="profilelink">Edit Profile</a></li>
            <li><a href="http://127.0.0.1:8000/runestone/default/user/change_password" id="passwordlink">Change Password</a></li>
            <li><a href="http://127.0.0.1:8000/runestone/default/user/register" id="registerlink">Register</a></li>
            <li class='loginout'><a href='#'>Login</a></li> <!-- correct link populated by addNavbarLoginLink() -->
          </ul>
        </li>
        <!-- end user account dropdown -->

        <li class="divider-vertical"></li>

        <!-- help menu dropdown -->
        <li class="dropdown">
          <a class="dropdown-toggle" href="#" data-toggle="dropdown">
            <i class="glyphicon glyphicon-question-sign" style="opacity:0.9;"></i>
          </a>
          <ul class="dropdown-menu user-menu">
            <li><a href='/runestone/static/pythonds/navhelp.html'>Navigation Help</a></li>
            <li><a href='/runestone/static/overview/instructor.html'>Help for Instructors</a></li>
            <li class="divider"></li>
            <li><a href='http://runestoneinteractive.org'>About Runestone</a></li>
            <li><a href='https://github.com/bnmnetp/runestone/issues/new'>Report A Problem</a></li>
          </ul>
        </li>
        <!-- end help menu dropdown -->

        <li class="divider-vertical"></li>

      </ul>

      <ul class="nav navbar-nav">
        <li class="divider-vertical"></li>
        <!--
          <li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown">Page <b class="caret"></b></a>
  <ul class="dropdown-menu localtoc"><ul>
<li><a class="reference internal" href="#">Симуляция: Задания на печать</a><ul>
<li><a class="reference internal" href="#id2">Основные шаги симуляции</a></li>
<li><a class="reference internal" href="#python">Реализация на Python</a></li>
<li><a class="reference internal" href="#id3">Обсуждение</a></li>
</ul>
</li>
</ul>
</ul>
</li>
          <li class="divider-vertical"></li>
        
        
          
  <li id="relations-prev" title="Previous Chapter - Симуляция: Hot Potato" data-toggle="tooltip">
    <a href="SimulationHotPotato.html" >
      <i class='glyphicon glyphicon-backward' style='opacity:0.9;'></i>
    </a>
  </li>
  
  <li id="relations-next" title='Next Chapter - Что такое дек?' data-toggle="tooltip" >
    <a href="WhatIsaDeque.html" >
      <i class='glyphicon glyphicon-forward' style='opacity:0.9;'></i>
    </a>
  </li>
  <li class="divider-vertical"></li>

<script type="text/javascript">
  opts = {'placement':'bottom',
          'selector': '',
          'delay': { show: 100, hide: 50}
         };

  $('#relations-prev').tooltip(opts);
  $('#relations-next').tooltip(opts);
</script>
        -->
        
          <li></li>
        
      </ul>

    </div>
  </div>
</div>


<div class="container" id="continue-reading"></div>

<div class="container" id="main-content">
  
  <div class="section" id="id1">
<h1>Симуляция: Задания на печать<a class="headerlink" href="#id1" title="Permalink to this headline">¶</a></h1>
<p>Более интересная симуляция позволит нам изучить поведение очереди на печать,
описанной ранее в этом разделе. Напомним, что когда студенты отправляют документы
для печати на общем принтере, то задания помещаются в очередь, чтобы быть
обработанными в манере &#8220;первым пришёл - первым обслужен&#8221;. В связи с такого рода
конфигурацией возникает много вопросов. Возможно, наиболее важный из них: способен
ли принтер обработать определённое количество документов? Если нет, то студенты будут
ждать чересчур долго и могут пропустить своё следующее занятие.</p>
<p>Рассмотрим такую ситуацию в лаборатории информатики. В любой среднестатистический
день в любой час в лаборатории работает порядка 10 студентов. В течение этого времени
они обычно печатают дважды, причём длина задания варьируется от одной до двадцати
страниц. Принтер в лаборатории стар и в черновом качестве способен обрабатывать всего
10 страниц в минуту. Можно переключить его на лучшее качество печати, но тогда
производительность упадёт до 5 страниц/мин. Низкая скорость печати заставляет студентов
ждать слишком долго. Какую скорость для страниц следует использовать?</p>
<p>Мы можем определить это, построив симуляционную модель лаборатории. Нам
потребуется создать представления студентов, заданий на печать и принтера
(<a class="reference internal" href="#fig-qulabsim"><em>Рисунок 4</em></a>). Когда студенты подают документы на печать,
мы будем добавлять их в список ожидания - очередь заданий на печать,
прикреплённую к принтеру. Когда принтер заканчивает очередное задание, он
смотрит в очередь на предмет наличия оставшихся документов для обработки.
Интерес для нас представляет среднее время ожидания задачи в очереди.</p>
<div class="figure align-center" id="fig-qulabsim">
<img alt="../_images/simulationsetup.png" src="../_images/simulationsetup.png" />
<p class="caption">Рисунок 4: Очередь на печать в лаборатории информатики</p>
</div>
<p>Для моделирования этой ситуации нам нужно использовать некоторые вероятности.
Например, студенты могут печатать документы величиной от одной до двадцати
страниц. Если каждая длина от 1 до 20 одинаково возможна, то текущий размер
задания на печать можно симулировать, используя случайное число от 1 до 20
включительно. Это означает, что шансы возникновения документа любой длины от
1 до 20 равны.</p>
<p>Если в лаборатории находятся десять студентов и каждый из них печатает дважды,
то в среднем в час будет 20 заданий на печать. Какова вероятность, что в любую
заданную секунду одно из них будет создано? Способ ответить на этот вопрос -
рассмотреть отношение количества заданий к времени. Двадцать заданий на час
означают одно задание на каждые 180 секунд:</p>
<p><span class="math">\(\frac {20\ tasks}{1\ hour} \times \frac {1\ hour}  {60\ minutes} \times \frac {1\ minute} {60\ seconds}=\frac {1\ task} {180\ seconds}\)</span></p>
<p>Для каждой секунды мы можем симулировать вероятность появления задания путём
генерации случайного числа между 1 и 180 включительно. Если число равно 180,
то мы говорим, что задание создано. Заметьте, что возможно создание множества
заданий одного за другим или наоборот - мы можем ждать долгое время, пока
что-то появится. Такова природа моделирования. Вы хотите симулировать реальную
ситуацию настолько близко к реальности, насколько это возможно, учитывая всё,
что знаете об общих параметрах.</p>
<div class="section" id="id2">
<h2>Основные шаги симуляции<a class="headerlink" href="#id2" title="Permalink to this headline">¶</a></h2>
<p>Вот основная модель.</p>
<ol class="arabic simple">
<li>Создать очередь из заданий на печать. Каждое из них будет иметь
отметку о времени постановки в очередь. В самом начале очередь пуста.</li>
<li>Для каждой секунды (<tt class="docutils literal"><span class="pre">currentSecond</span></tt>):<ul>
<li>Создано ли новое задание на печать? Если да, то добавить его в очередь
с <tt class="docutils literal"><span class="pre">currentSecond</span></tt> в качестве отметки времени.</li>
<li>Если принтер не занят и есть ожидающее задание, то<ul>
<li>Удалить следующее задание из очереди на печать и передать его принтеру.</li>
<li>Извлечь отметку о времени из <tt class="docutils literal"><span class="pre">currentSecond</span></tt> чтобы вычислить время
ожидания для данного задания.</li>
<li>Добавить время ожидания этой задачи в список для дальнейшей обработки.</li>
<li>Основываясь на количестве страниц в задании на печать, вычислить,
сколько для него потребуется времени.</li>
</ul>
</li>
<li>Если необходимо, принтер тратит одну секунду печати. Также он вычитает её из
времени, необходимого для выполнения задачи.</li>
<li>Если задание завершено (другими словами, требуемое на его выполнение время
равно нулю), то принтер более не занят.</li>
</ul>
</li>
<li>После завершения симуляции вычисляется среднее время ожидания из сгенерированного
списка времён ожидания.</li>
</ol>
</div>
<div class="section" id="python">
<h2>Реализация на Python<a class="headerlink" href="#python" title="Permalink to this headline">¶</a></h2>
<p>Для этой симуляции мы создадим классы трёх объектов реального мира, описанных выше:
<tt class="docutils literal"><span class="pre">Printer</span></tt>, <tt class="docutils literal"><span class="pre">Task</span></tt>, и <tt class="docutils literal"><span class="pre">PrintQueue</span></tt>.</p>
<p>Классу <tt class="docutils literal"><span class="pre">Printer</span></tt> (<a class="reference internal" href="#lst-printer"><em>Листинг 2</em></a>) будет необходима возможность
отслеживать, имеет ли он текущую задачу. Если да, то он занят (строки 13-17), и
необходимо вычислить временнЫе затраты, исходя из количества страниц в задании.
Так же конструктор позволяет инициализировать настройку количества печатаемых в
минуту страниц. Метод <tt class="docutils literal"><span class="pre">tick</span></tt> уменьшает на единицу внутренний таймер и устанавливает
холостой ход принтера (строка 11), если задание выполнено.</p>
<p id="lst-printer"><strong>Листинг 2</strong></p>
<div class="highlight-python"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21</pre></div></td><td class="code"><div class="highlight"><pre><span class="k">class</span> <span class="nc">Printer</span><span class="p">:</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ppm</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">pagerate</span> <span class="o">=</span> <span class="n">ppm</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">currentTask</span> <span class="o">=</span> <span class="bp">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">timeRemaining</span> <span class="o">=</span> <span class="mi">0</span>

    <span class="k">def</span> <span class="nf">tick</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">currentTask</span> <span class="o">!=</span> <span class="bp">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">timeRemaining</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">timeRemaining</span> <span class="o">-</span> <span class="mi">1</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">timeRemaining</span> <span class="o">&lt;=</span> <span class="mi">0</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">currentTask</span> <span class="o">=</span> <span class="bp">None</span>

    <span class="k">def</span> <span class="nf">busy</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">currentTask</span> <span class="o">!=</span> <span class="bp">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">True</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">False</span>

    <span class="k">def</span> <span class="nf">startNext</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">newtask</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">currentTask</span> <span class="o">=</span> <span class="n">newtask</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">timeRemaining</span> <span class="o">=</span> <span class="n">newtask</span><span class="o">.</span><span class="n">getPages</span><span class="p">()</span> <span class="o">*</span> <span class="mi">60</span><span class="o">/</span><span class="bp">self</span><span class="o">.</span><span class="n">pagerate</span>
</pre></div>
</td></tr></table></div>
<p>Класс заданий (<a class="reference internal" href="#lst-task"><em>Листинг 3</em></a>) будет представлять единичное задание
для печати. Когда оно создаётся, генератор случайных чисел предоставляет его длину
в диапазоне от 1 до 20 страниц. Мы выбрали использование функции <tt class="docutils literal"><span class="pre">randrange</span></tt>
из модуля <tt class="docutils literal"><span class="pre">random</span></tt>.</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">random</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">random</span><span class="o">.</span><span class="n">randrange</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">21</span><span class="p">)</span>
<span class="go">18</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">random</span><span class="o">.</span><span class="n">randrange</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">21</span><span class="p">)</span>
<span class="go">8</span>
<span class="go">&gt;&gt;&gt;</span>
</pre></div>
</div>
<p>Так же каждое задание нуждается в отметке, которая будет использоваться для подсчёта
времени ожидания. Она будет представлять из себя момент, когда задание было создано
и помещено в очередь принтера. Затем может быть использован метод <tt class="docutils literal"><span class="pre">waitTime</span></tt> для
извлечения времени, затраченного на ожидание в очереди начала печати.</p>
<p id="lst-task"><strong>Листинг 3</strong></p>
<div class="highlight-python"><div class="highlight"><pre><span class="kn">import</span> <span class="nn">random</span>

<span class="k">class</span> <span class="nc">Task</span><span class="p">:</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">time</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">timestamp</span> <span class="o">=</span> <span class="n">time</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">pages</span> <span class="o">=</span> <span class="n">random</span><span class="o">.</span><span class="n">randrange</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">21</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">getStamp</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">timestamp</span>

    <span class="k">def</span> <span class="nf">getPages</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">pages</span>

    <span class="k">def</span> <span class="nf">waitTime</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">currenttime</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">currenttime</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">timestamp</span>
</pre></div>
</div>
<p>Основная симуляция (<a class="reference internal" href="#lst-qumainsim"><em>Листинг 4</em></a>) реализует алгоритм, описанный
выше. Объект <tt class="docutils literal"><span class="pre">printQueue</span></tt> представляет собой экземпляр нашего существующего АТД
очереди. Вспомогательная булева функция <tt class="docutils literal"><span class="pre">newPrintTask</span></tt> определяет, было ли создано
новое задание на печать. Мы вновь выбрали функцию <tt class="docutils literal"><span class="pre">randrange</span></tt> из модуля <tt class="docutils literal"><span class="pre">random</span></tt>,
чтобы возвращать случайное целое из диапазона от 1 до 180. Задания на печать появляются
раз в каждые 180 секунд. Произвольно выбрав 180 из диапазона целых чисел (строка 32),
мы можем симулировать это случайное событие. Функция симуляции позволяет нам установить
для принтера общее время и количество страниц в минуту.</p>
<p id="lst-qumainsim"><strong>Листинг 4</strong></p>
<div class="highlight-python"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35</pre></div></td><td class="code"><div class="highlight"><pre><span class="kn">from</span> <span class="nn">pythonds.basic.queue</span> <span class="kn">import</span> <span class="n">Queue</span>

<span class="kn">import</span> <span class="nn">random</span>

<span class="k">def</span> <span class="nf">simulation</span><span class="p">(</span><span class="n">numSeconds</span><span class="p">,</span> <span class="n">pagesPerMinute</span><span class="p">):</span>

    <span class="n">labprinter</span> <span class="o">=</span> <span class="n">Printer</span><span class="p">(</span><span class="n">pagesPerMinute</span><span class="p">)</span>
    <span class="n">printQueue</span> <span class="o">=</span> <span class="n">Queue</span><span class="p">()</span>
    <span class="n">waitingtimes</span> <span class="o">=</span> <span class="p">[]</span>

    <span class="k">for</span> <span class="n">currentSecond</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">numSeconds</span><span class="p">):</span>

      <span class="k">if</span> <span class="n">newPrintTask</span><span class="p">():</span>
         <span class="n">task</span> <span class="o">=</span> <span class="n">Task</span><span class="p">(</span><span class="n">currentSecond</span><span class="p">)</span>
         <span class="n">printQueue</span><span class="o">.</span><span class="n">enqueue</span><span class="p">(</span><span class="n">task</span><span class="p">)</span>

      <span class="k">if</span> <span class="p">(</span><span class="ow">not</span> <span class="n">labprinter</span><span class="o">.</span><span class="n">busy</span><span class="p">())</span> <span class="ow">and</span> <span class="p">(</span><span class="ow">not</span> <span class="n">printQueue</span><span class="o">.</span><span class="n">isEmpty</span><span class="p">()):</span>
        <span class="n">nexttask</span> <span class="o">=</span> <span class="n">printQueue</span><span class="o">.</span><span class="n">dequeue</span><span class="p">()</span>
        <span class="n">waitingtimes</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">nexttask</span><span class="o">.</span><span class="n">waitTime</span><span class="p">(</span><span class="n">currentSecond</span><span class="p">))</span>
        <span class="n">labprinter</span><span class="o">.</span><span class="n">startNext</span><span class="p">(</span><span class="n">nexttask</span><span class="p">)</span>

      <span class="n">labprinter</span><span class="o">.</span><span class="n">tick</span><span class="p">()</span>

    <span class="n">averageWait</span><span class="o">=</span><span class="nb">sum</span><span class="p">(</span><span class="n">waitingtimes</span><span class="p">)</span><span class="o">/</span><span class="nb">len</span><span class="p">(</span><span class="n">waitingtimes</span><span class="p">)</span>
    <span class="k">print</span><span class="p">(</span><span class="s">&quot;Average Wait </span><span class="si">%6.2f</span><span class="s"> secs </span><span class="si">%3d</span><span class="s"> tasks remaining.&quot;</span><span class="o">%</span><span class="p">(</span><span class="n">averageWait</span><span class="p">,</span><span class="n">printQueue</span><span class="o">.</span><span class="n">size</span><span class="p">()))</span>

<span class="k">def</span> <span class="nf">newPrintTask</span><span class="p">():</span>
    <span class="n">num</span> <span class="o">=</span> <span class="n">random</span><span class="o">.</span><span class="n">randrange</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">181</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">num</span> <span class="o">==</span> <span class="mi">180</span><span class="p">:</span>
        <span class="k">return</span> <span class="bp">True</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="bp">False</span>

<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">10</span><span class="p">):</span>
    <span class="n">simulation</span><span class="p">(</span><span class="mi">3600</span><span class="p">,</span><span class="mi">5</span><span class="p">)</span>
</pre></div>
</td></tr></table></div>
<p>Когда мы запускаем симуляцию, нас не должно беспокоить, что результаты каждый
раз будут разными. Это заложено в вероятностную природу случайных чисел. Нас
интересуют тенденции, которые появляются при корректировке параметров симуляции.
Вот некоторые результаты.</p>
<p>В первый раз мы запускаем симуляцию для периода в 60 минут (3600 секунд), используя
скорость печати 5 страниц в минуту. Дополнительно мы проводим 10 независимых попыток.
Помните, что поскольку симуляция работает со случайными числами, то на каждом запуске
мы получим разные результаты.</p>
<div class="highlight-python"><div class="highlight"><pre><span class="go">&gt;&gt;&gt;for i in range(10):</span>
<span class="go">      simulation(3600,5)</span>

<span class="go">Average Wait 165.38 secs 2 tasks remaining.</span>
<span class="go">Average Wait  95.07 secs 1 tasks remaining.</span>
<span class="go">Average Wait  65.05 secs 2 tasks remaining.</span>
<span class="go">Average Wait  99.74 secs 1 tasks remaining.</span>
<span class="go">Average Wait  17.27 secs 0 tasks remaining.</span>
<span class="go">Average Wait 239.61 secs 5 tasks remaining.</span>
<span class="go">Average Wait  75.11 secs 1 tasks remaining.</span>
<span class="go">Average Wait  48.33 secs 0 tasks remaining.</span>
<span class="go">Average Wait  39.31 secs 3 tasks remaining.</span>
<span class="go">Average Wait 376.05 secs 1 tasks remaining.</span>
</pre></div>
</div>
<p>После запуска наших десяти попыток мы видим, что среднее время ожидания
составляет 122,155 секунд. Так же заметен большой разброс средних весов
времени от 17,27 до максимальных 376,05 секунд. Обратите внимание, что
задания завершили выполнение всего в двух случаях.</p>
<p>А теперь установим скорость печать на 10 страниц в минуту и вновь запустим
10 попыток. С большей скоростью мы можем надеяться выполнить больше заданий
в рамках одного часа.</p>
<div class="highlight-python"><div class="highlight"><pre><span class="go">&gt;&gt;&gt;for i in range(10):</span>
<span class="go">      simulation(3600,10)</span>

<span class="go">Average Wait   1.29 secs 0 tasks remaining.</span>
<span class="go">Average Wait   7.00 secs 0 tasks remaining.</span>
<span class="go">Average Wait  28.96 secs 1 tasks remaining.</span>
<span class="go">Average Wait  13.55 secs 0 tasks remaining.</span>
<span class="go">Average Wait  12.67 secs 0 tasks remaining.</span>
<span class="go">Average Wait   6.46 secs 0 tasks remaining.</span>
<span class="go">Average Wait  22.33 secs 0 tasks remaining.</span>
<span class="go">Average Wait  12.39 secs 0 tasks remaining.</span>
<span class="go">Average Wait   7.27 secs 0 tasks remaining.</span>
<span class="go">Average Wait  18.17 secs 0 tasks remaining.</span>
</pre></div>
</div>
<p>Вы можете запустить симуляцию самостоятельно в ActiveCode 2.</p>

<div id="cont"></div>
<div id="qumainsim" lang="python" class="ac_section alert alert-warning" >

<div class="ac_actions">
<button class='btn btn-success' id="qumainsim_runb">Run</button>
<button class="ac_opt btn btn-default" style="display: inline-block" id="qumainsim_saveb" onclick="saveEditor('qumainsim');">Save</button>
<button class="ac_opt btn btn-default" style="display: inline-block" id="qumainsim_loadb" onclick="requestCode('qumainsim');">Load</button>

</div>
<br/>
<div id="qumainsim_code_div" style="display: block" class="ac_code_div">
<textarea cols="50" rows="12" id="qumainsim_code" class="active_code", prefixcode="undefined" lang="python">
from pythonds.basic.queue import Queue

import random

class Printer:
    def __init__(self, ppm):
        self.pagerate = ppm
        self.currentTask = None
        self.timeRemaining = 0

    def tick(self):
        if self.currentTask != None:
            self.timeRemaining = self.timeRemaining - 1
            if self.timeRemaining <= 0:
                self.currentTask = None

    def busy(self):
        if self.currentTask != None:
            return True
        else:
            return False

    def startNext(self,newtask):
        self.currentTask = newtask
        self.timeRemaining = newtask.getPages() * 60/self.pagerate

class Task:
    def __init__(self,time):
        self.timestamp = time
        self.pages = random.randrange(1,21)

    def getStamp(self):
        return self.timestamp

    def getPages(self):
        return self.pages

    def waitTime(self, currenttime):
        return currenttime - self.timestamp


def simulation(numSeconds, pagesPerMinute):

    labprinter = Printer(pagesPerMinute)
    printQueue = Queue()
    waitingtimes = []

    for currentSecond in range(numSeconds):

      if newPrintTask():
         task = Task(currentSecond)
         printQueue.enqueue(task)

      if (not labprinter.busy()) and (not printQueue.isEmpty()):
        nexttask = printQueue.dequeue()
        waitingtimes.append( nexttask.waitTime(currentSecond))
        labprinter.startNext(nexttask)

      labprinter.tick()

    averageWait=sum(waitingtimes)/len(waitingtimes)
    print("Average Wait %6.2f secs %3d tasks remaining."%(averageWait,printQueue.size()))

def newPrintTask():
    num = random.randrange(1,181)
    if num == 180:
        return True
    else:
        return False

for i in range(10):
    simulation(3600,5)
</textarea>
</div>
<div class="ac_output">
<div style="text-align: center">
<canvas id="qumainsim_canvas" class="ac-canvas" height="400" width="400" style="border-style: solid; display: none; text-align: center"></canvas>
</div>
<pre id="qumainsim_suffix" style="display:none">
</pre><pre id="qumainsim_pre" class="active_out">

</pre>

</div> 
<div class="clearfix"></div>
<p class="ac_caption"><span class="ac_caption_text">Симуляция очереди принтера (qumainsim)</span> </p>

<script>
if ('block' == 'none') {
    // a hack to preserve the inline-block display style. Toggle() will use display: block
    // (instead of inline-block) if the previous display style was 'none'
    $('#qumainsim_saveb').toggle();
    $('#qumainsim_loadb').toggle();
}
if ($("#qumainsim_code_div").parents(".admonition").length == 0 && $("#qumainsim_code_div").parents("#exercises").length == 0){
	if ($(window).width() > 975){
		$("#qumainsim_code_div").offset({
			left: $("#qumainsim .clearfix").offset().left
		});
	}
	$("#qumainsim_runb").one("click", function(){
		$({})
		.queue(function (next) {
			if ($(window).width() > 975){
				$("#qumainsim_code_div").animate({
					left: 40
				}, 500, next);
			}
			else{
				next();
			}
		})
		.queue(function (next) {
			$("#qumainsim_runb").parent().siblings(".ac_output").show();
			runit('qumainsim',this, undefined);
			$("#qumainsim_runb").on("click", function(){
				runit('qumainsim',this, undefined);
			});
		})
		
	});
}
else{
	console.log("inside new if")
	$("#qumainsim_code_div").css({float : "none", marginLeft : "auto", marginRight : "auto"});
	$("#qumainsim_runb").parent().siblings(".ac_output").show().css({float : "none", right : "0px"});
	$("#qumainsim_runb").on("click", function(){
		console.log("button clicked");
		runit('qumainsim',this, undefined);
	});
}
</script>

</div>

</div>
<div class="section" id="id3">
<h2>Обсуждение<a class="headerlink" href="#id3" title="Permalink to this headline">¶</a></h2>
<p>Мы пытались ответить на вопрос о том, может ли текущий принтер обработать
загруженное задание, если установлена печать лучшего качества, но с более
низкой скоростью. Подход, который мы использовали для написания симуляции,
моделировал задания на печать как случайные события различной длины и времени
появления.</p>
<p>Вывод выше показывает, что с пятью страницами в минуту среднее время ожидания
варьируется от 17 до 376 секунд (около шести минут). С более высокой скоростью
печати нижним значением становится одна секунда, а верхним - всего 28. Более
того, в 8 из 10 запусков при 5 страниц/мин по истечение часа в очереди остаются
ожидающие задания.</p>
<p>Таким образом, мы, возможно, убедились, что снижение скорости печати в пользу
улучшения качества - не самая лучшая идея. Студенты не могут позволить себе так
долго ждать свои документы, особенно когда им надо спешить на следующую пару.
Шестиминутное ожидание будет просто чересчур долгим.</p>
<p>Такой тип анализа симуляции позволяет нам ответить на множество вопросов, в целом
известных как &#8220;что, если?&#8221;. Всё, что нужно - это менять параметры, используемые для
симуляции, и тогда мы можем моделировать любое количество интересных случаев. Например,</p>
<ul class="simple">
<li>Что, если возрастёт среднее число принятых заявок на печать, а среднее
количество студентов увеличится до 20 человек?</li>
<li>Что, если сегодня суббота, и студентам не нужно идти на занятия? Могут
ли они позволить себе ожидание?</li>
<li>Что, если размер среднего задания на печать уменьшится, поскольку Python -
очень мощный язык, и программы на нём имеют тенденцию становиться короче?</li>
</ul>
<p>На все эти вопросы можно ответить, модифицируя симуляцию выше. Однако, важно
помнить, что модель хороша настолько, насколько хороши допущения, на которых
она построена. Для создания надёжной модели были необходимы настоящие данные
о числе заданий на печать и количестве студентов в час.</p>
<div class="admonition- admonition">
<p class="first admonition-title">Самопроверка</p>
<p>Как бы вы модифицировали симуляцию принтера, чтобы отразить большее число студентов? Предположим, что оно удвоилось. Вам необходимо сделать некоторые разумные допущения о том, как связать это с данной моделью. Что бы вы изменили? Модифицируйте код. Также предположите, что длина среднего задания на печать уменьшилась в половину. Измените код, чтобы отразить это. Наконец, как бы вы параметризировали количество студентов? Вместо того, чтобы каждый раз изменять код, мы бы предпочли просто задавать число студентов параметром симуляции.</p>

<div id="cont"></div>
<div id="print_sim_selfcheck" lang="python" class="ac_section alert alert-warning" >

<div class="ac_actions">
<button class='btn btn-success' id="print_sim_selfcheck_runb">Run</button>
<button class="ac_opt btn btn-default" style="display: inline-block" id="print_sim_selfcheck_saveb" onclick="saveEditor('print_sim_selfcheck');">Save</button>
<button class="ac_opt btn btn-default" style="display: inline-block" id="print_sim_selfcheck_loadb" onclick="requestCode('print_sim_selfcheck');">Load</button>

<span class="ac_sep"></span>
<button class='btn btn-default' id="print_sim_selfcheck_showb" onclick="$('#print_sim_selfcheck_code_div').toggle();cm_editors['print_sim_selfcheck_code'].refresh();$('#print_sim_selfcheck_saveb').toggle();$('#print_sim_selfcheck_loadb').toggle()">Show/Hide Code</button>

<span class="ac_sep"></span>
<input type="button" class='btn btn-default ' id="gradeb" name="Show Feedback" value="Show Feedback" onclick="createGradeSummary('print_sim_selfcheck')"/>

</div>
<br/>
<div id="print_sim_selfcheck_code_div" style="display: none" class="ac_code_div">
<textarea cols="50" rows="12" id="print_sim_selfcheck_code" class="active_code", prefixcode="undefined" lang="python">
from pythonds.basic.queue import Queue

import random

class Printer:
    def __init__(self, ppm):
        self.pagerate = ppm
        self.currentTask = None
        self.timeRemaining = 0

    def tick(self):
        if self.currentTask != None:
            self.timeRemaining = self.timeRemaining - 1
            if self.timeRemaining <= 0:
                self.currentTask = None

    def busy(self):
        if self.currentTask != None:
            return True
        else:
            return False

    def startNext(self,newtask):
        self.currentTask = newtask
        self.timeRemaining = newtask.getPages() * 60/self.pagerate

class Task:
    def __init__(self,time):
        self.timestamp = time
        self.pages = random.randrange(1,21)

    def getStamp(self):
        return self.timestamp

    def getPages(self):
        return self.pages

    def waitTime(self, currenttime):
        return currenttime - self.timestamp


def simulation(numSeconds, pagesPerMinute):

    labprinter = Printer(pagesPerMinute)
    printQueue = Queue()
    waitingtimes = []

    for currentSecond in range(numSeconds):

      if newPrintTask():
         task = Task(currentSecond)
         printQueue.enqueue(task)

      if (not labprinter.busy()) and (not printQueue.isEmpty()):
        nexttask = printQueue.dequeue()
        waitingtimes.append(nexttask.waitTime(currentSecond))
        labprinter.startNext(nexttask)

      labprinter.tick()

    averageWait=sum(waitingtimes)/len(waitingtimes)
    print("Average Wait %6.2f secs %3d tasks remaining." % (averageWait,printQueue.size()))

def newPrintTask():
    num = random.randrange(1,181)
    if num == 180:
        return True
    else:
        return False

for i in range(10):
    simulation(3600,5)
</textarea>
</div>
<div class="ac_output">
<div style="text-align: center">
<canvas id="print_sim_selfcheck_canvas" class="ac-canvas" height="400" width="400" style="border-style: solid; display: none; text-align: center"></canvas>
</div>
<pre id="print_sim_selfcheck_suffix" style="display:none">
</pre><pre id="print_sim_selfcheck_pre" class="active_out">

</pre>

</div> 
<div class="clearfix"></div>
<p class="ac_caption"><span class="ac_caption_text"> (print_sim_selfcheck)</span> </p>

<script>
if ('none' == 'none') {
    // a hack to preserve the inline-block display style. Toggle() will use display: block
    // (instead of inline-block) if the previous display style was 'none'
    $('#print_sim_selfcheck_saveb').toggle();
    $('#print_sim_selfcheck_loadb').toggle();
}
if ($("#print_sim_selfcheck_code_div").parents(".admonition").length == 0 && $("#print_sim_selfcheck_code_div").parents("#exercises").length == 0){
	if ($(window).width() > 975){
		$("#print_sim_selfcheck_code_div").offset({
			left: $("#print_sim_selfcheck .clearfix").offset().left
		});
	}
	$("#print_sim_selfcheck_runb").one("click", function(){
		$({})
		.queue(function (next) {
			if ($(window).width() > 975){
				$("#print_sim_selfcheck_code_div").animate({
					left: 40
				}, 500, next);
			}
			else{
				next();
			}
		})
		.queue(function (next) {
			$("#print_sim_selfcheck_runb").parent().siblings(".ac_output").show();
			runit('print_sim_selfcheck',this, undefined);
			$("#print_sim_selfcheck_runb").on("click", function(){
				runit('print_sim_selfcheck',this, undefined);
			});
		})
		
	});
}
else{
	console.log("inside new if")
	$("#print_sim_selfcheck_code_div").css({float : "none", marginLeft : "auto", marginRight : "auto"});
	$("#print_sim_selfcheck_runb").parent().siblings(".ac_output").show().css({float : "none", right : "0px"});
	$("#print_sim_selfcheck_runb").on("click", function(){
		console.log("button clicked");
		runit('print_sim_selfcheck',this, undefined);
	});
}
</script>

</div>

</div>
</div>
</div>


  
      
  <li id="relations-prev" class="navLink" title='Previous Section - Симуляция: Hot Potato' data-toggle="tooltip">
    <a href="SimulationHotPotato.html" >
      <i class='prevNav glyphicon glyphicon-chevron-left'></i>
    </a>
  </li>
  <a class="navLinkBg" id="navLinkBgLeft"  href="SimulationHotPotato.html" ></a>
  
  <li id="relations-next" class="navLink" title='Next Section - Что такое дек?' data-toggle="tooltip" >
    <a href="WhatIsaDeque.html" >
      <i id="relationsNextIcon" class='nextNav glyphicon glyphicon-chevron-right'></i>
    </a>
  </li>
  <a class="navLinkBg navLink" id="navLinkBgRight" href="WhatIsaDeque.html" >Next Section - Что такое дек?</a>

<script type="text/javascript">

  $('#relations-prev').tooltip({'placement':'right', 'selector': '', 'delay': { show: 100, hide: 50}});
  $('#relations-next').tooltip({'placement':'left', 'selector': '', 'delay': { show: 100, hide: 50}});
  
</script>
  
</div>
<footer class="footer">
  <div class="container">
    <p class="pull-right">
      <span id='numuserspan'></span> readers online now | <span class='loggedinuser'></span> | <a href="#">Back to top</a>
      
    </p>
    <p>
        &copy; Copyright 2013 Brad Miller, David Ranum.
      Created using <a href="http://sphinx.pocoo.org/">Sphinx</a> 1.2.2.
    </p>
  </div>
</footer>

<script type="text/javascript" charset="utf-8">
    $(document).ready(addUserToFooter);
    $(document).ready(addNavbarLoginLink);
    $(document).ready(createEditors);
    $(document).ready(getNumUsers);
    $(document).ready(getOnlineUsers);
    $(document).ready(createScratchActivecode());
    $(document).ready(styleUnittestResults());
</script>

<script type="text/javascript">
  // add the video play button overlay image
  $(".video-play-overlay").each(function() {
    $(this).css('background-image', "url(\'../_static/play_overlay_icon.png\')")
    });

  // This function is needed to allow the dropdown search bar to work;
  // The default behaviour is that the dropdown menu closes when something in
  // it (like the search bar) is clicked
  $(function() {
    // Fix input element click problem
    $('.dropdown input, .dropdown label').click(function(e) {
      e.stopPropagation();
      });
  });

  // style codelens buttons (doing it here because PyTutor is a submodule owned by someone else
  $(function() {
    $(".ExecutionVisualizer").each(function() {
      $(this).find("#jmpFirstInstr").addClass('btn btn-default');
      $(this).find("#jmpStepBack").addClass('btn btn-danger');
      $(this).find("#jmpStepFwd").addClass('btn btn-success');
      $(this).find("#jmpLastInstr").addClass('btn btn-default');
      });
  });

</script>


<script type="text/javascript">
  var _gaq = _gaq || [];
  _gaq.push(['_setAccount', 'UA-32029811-1']);
  _gaq.push(['_trackPageview']);

  (function() {
    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
  })();
</script>



  </body>
</html>