<!DOCTYPE html>


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>Списки &mdash; Problem Solving with Algorithms and Data Structures</title>
    
    <link rel="stylesheet" href="../_static/basic.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="../_static/bootstrap-3.0.0/css/bootstrap.min.css" type="text/css" />
    <link rel="stylesheet" href="../_static/video.css" type="text/css" />
    <link rel="stylesheet" href="../_static/poll.css" type="text/css" />
    <link rel="stylesheet" href="../_static/tabbedstuff.css" type="text/css" />
    <link rel="stylesheet" href="../_static/css/pytutor.css" type="text/css" />
    <link rel="stylesheet" href="../_static/css/basic.css" type="text/css" />
    <link rel="stylesheet" href="../_static/codemirror.css" type="text/css" />
    <link rel="stylesheet" href="../_static/activecode.css" type="text/css" />
    <link rel="stylesheet" href="../_static/parsons.css" type="text/css" />
    <link rel="stylesheet" href="../_static/lib/prettify.css" type="text/css" />
    <link rel="stylesheet" href="../_static/jquery-ui-1.10.3.custom.min.css" type="text/css" />
    <link rel="stylesheet" href="../_static/bootstrap-sphinx.css" type="text/css" />
    <link rel="stylesheet" href="../_static/user-highlights.css" type="text/css" />
    <link rel="stylesheet" href="../_static/runestone-custom-sphinx-bootstrap.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../',
        VERSION:     '3.0',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <script type="text/javascript" src="../_static/poll.js"></script>
    <script type="text/javascript" src="../_static/js/d3.v2.min.js"></script>
    <script type="text/javascript" src="../_static/jquery-migrate-1.2.1.min.js"></script>
    <script type="text/javascript" src="../_static/js/jquery.ba-bbq.min.js"></script>
    <script type="text/javascript" src="../_static/js/jquery.jsPlumb-1.3.10-all-min.js"></script>
    <script type="text/javascript" src="../_static/js/pytutor.js"></script>
    <script type="text/javascript" src="../_static/jquery.highlight.js"></script>
    <script type="text/javascript" src="../_static/bookfuncs.js"></script>
    <script type="text/javascript" src="../_static/codemirror.js"></script>
    <script type="text/javascript" src="../_static/python.js"></script>
    <script type="text/javascript" src="../_static/javascript.js"></script>
    <script type="text/javascript" src="../_static/activecode.js"></script>
    <script type="text/javascript" src="../_static/skulpt.min.js"></script>
    <script type="text/javascript" src="../_static/skulpt-stdlib.js"></script>
    <script type="text/javascript" src="../_static/assess.js"></script>
    <script type="text/javascript" src="../_static/animationbase.js"></script>
    <script type="text/javascript" src="../_static/lib/jquery.min.js"></script>
    <script type="text/javascript" src="../_static/lib/jquery-ui.min.js"></script>
    <script type="text/javascript" src="../_static/lib/prettify.js"></script>
    <script type="text/javascript" src="../_static/lib/underscore-min.js"></script>
    <script type="text/javascript" src="../_static/lib/lis.js"></script>
    <script type="text/javascript" src="../_static/parsons.js"></script>
    <script type="text/javascript" src="../_static/parsons-noconflict.js"></script>
    <script type="text/javascript" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <script type="text/javascript" src="../_static/jquery-ui-1.10.3.custom.min.js"></script>
    <script type="text/javascript" src="../_static/jquery-fix.js"></script>
    <script type="text/javascript" src="../_static/bootstrap-3.0.0/js/bootstrap.min.js"></script>
    <script type="text/javascript" src="../_static/bootstrap-sphinx.js"></script>
    <script type="text/javascript" src="../_static/waypoints.min.js"></script>
    <script type="text/javascript" src="../_static/rangy-core.js"></script>
    <script type="text/javascript" src="../_static/rangy-textrange.js"></script>
    <script type="text/javascript" src="../_static/rangy-cssclassapplier.js"></script>
    <script type="text/javascript" src="../_static/user-highlights.js"></script>
    <script type="text/javascript" src="../_static/jquery.idle-timer.js"></script>
    <script type="text/javascript" src="../_static/processing-1.4.1.min.js"></script>
    <script type="text/javascript" src="../_static/jquery.hotkey.js"></script>
    <link rel="top" title="Problem Solving with Algorithms and Data Structures" href="../index.html" />
    <link rel="next" title="Словари" href="Dictionaries.html" />
    <link rel="prev" title="Производительность структур данных в Python" href="PerformanceofPythonDataStructures.html" />
<meta charset='utf-8'>
<meta http-equiv='X-UA-Compatible' content='IE=edge,chrome=1'>
<meta content='width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0' name='viewport' />
<script type="text/javascript">
  eBookConfig = {};
  eBookConfig.host = 'http://127.0.0.1:8000' ? 'http://127.0.0.1:8000' : 'http://127.0.0.1:8000';
  eBookConfig.app = eBookConfig.host+'/runestone';
  eBookConfig.ajaxURL = eBookConfig.app+'/ajax/';
  eBookConfig.course = 'pythonds';
  eBookConfig.logLevel = 10;
  eBookConfig.loginRequired = false
  eBookConfig.build_info = "2.1.5";
  eBookConfig.isLoggedIn = false;
</script>

<div id="fb-root"></div>
<script>
  (function(d, s, id) {
    var js, fjs = d.getElementsByTagName(s)[0];
    if (d.getElementById(id)) return;
    js = d.createElement(s); js.id = id;
    js.src = "//connect.facebook.net/en_US/all.js#xfbml=1&status=0";
    fjs.parentNode.insertBefore(js, fjs);
  }(document, 'script', 'facebook-jssdk'));
</script>


<script>
var _prum = [['id', '521dfcc4abe53d0749000000'],
             ['mark', 'firstbyte', (new Date()).getTime()]];
(function() {
    var s = document.getElementsByTagName('script')[0]
      , p = document.createElement('script');
    p.async = 'async';
    p.src = '//rum-static.pingdom.net/prum.min.js';
    s.parentNode.insertBefore(p, s);
})();
</script>



  </head>
  <body>


<!-- Begin navbar -->
<div id="navbar" class="navbar navbar-default navbar-fixed-top" role="navigation">

  <div class="container">

    <div class="navbar-header">
      <!-- .btn-navbar is used as the toggle for collapsed navbar content -->
      <button type='button' class='navbar-toggle' data-toggle="collapse" data-target=".navbar-ex1-collapse">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>

      <div>
        <a class="brand-logo" style='background: transparent url("../_static/img/logo_small.png") no-repeat 0px 0px;' href="/runestone/default/user/login">&nbsp; </a>
        <a class="navbar-brand" href="../index.html">Problem Solving with Algorithms and Data Structures</a>
      </div>
    </div>

    <div class="navbar-collapse collapse navbar-ex1-collapse">

      <ul class="nav navbar-nav navbar-right">

        <li class="divider-vertical"></li>

        <!-- social media dropdown -->
        <li class="dropdown">
          <a class="dropdown-toggle" href="#" data-toggle="dropdown">
            <i class="glyphicon glyphicon-share-alt" style="opacity: 0.9"></i>
          </a>
          <ul class="dropdown-menu social-menu">
              <li>
                <div>
                  <b>Runestone in social media:</b>
                </div>
                <a href="https://twitter.com/iRunestone" class="twitter-follow-button" data-show-count="true">Follow @iRunestone</a><script>!function(d,s,id){var js,fjs=d.getElementsByTagName(s)[0],p=/^http:/.test(d.location)?'http':'https';if(!d.getElementById(id)){js=d.createElement(s);js.id=id;js.src=p+'://platform.twitter.com/widgets.js';fjs.parentNode.insertBefore(js,fjs);}}(document, 'script', 'twitter-wjs');</script>
                <div class="fb-like" data-href="https://www.facebook.com/RunestoneInteractive" data-send="false" data-layout="button_count" data-width="300" data-show-faces="false" data-font="arial"></div>
              </li>

              <li class="divider"></li>
              <li>
                <div>
                  <b>Help support us:</b>
                </div>
                <div class="gittip">
                  <iframe style="border:0;"
                    src="https://www.gittip.com/bnmnetp/widget.html"
                    width="48pt" height="22pt" class="gittip-button">
                  </iframe>
                </div>
                <div>
                    <form action="https://www.paypal.com/cgi-bin/webscr" method="post" target="_top">
                  <input type="hidden" name="cmd" value="_s-xclick">
                  <input type="hidden" name="encrypted" value="-----BEGIN PKCS7-----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-----END PKCS7-----
                  ">
                  <input type="image" src="https://www.paypalobjects.com/en_US/i/btn/btn_donate_SM.gif" border="0" name="submit" alt="PayPal - The safer, easier way to pay online!">
                  <img alt="" border="0" src="https://www.paypalobjects.com/en_US/i/scr/pixel.gif" width="1" height="1">
                  </form>

                </div>
              </li>
          </ul>
        </li>
        <!-- end social media dropdown -->

        <li class="divider-vertical"></li>

        <!-- search dropdown -->
        <li class="dropdown">
          <a class="dropdown-toggle" href="#" data-toggle="dropdown">
            <i class="glyphicon glyphicon-search" style='opacity:0.9;'></i>
          </a>
          <ul class='dropdown-menu'>
            
                <li><a href='../index.html'>Table of Contents</a></li>
            
            <li><a href='/runestone/static/pythonds/genindex.html'>Book Index</a></li>
            <li class="divider"></li>
            <li id="scratch_ac_link"><a href="javascript:toggleScratchActivecode()">Scratch ActiveCode</a></li>
            <li class="divider"></li>
            <li style="width: 240px;">
              <form class="navbar-search" style="margin:10px;" action="../search.html" method="get">
                <div class="input-group">
                  <input type="text" class="form-control" name="q" placeholder="Search this book" />
                  <span class="input-group-btn">
                    <button class="btn btn-primary" style="margin:0;" type="submit">
                      <i class="glyphicon glyphicon-search"></i>
                    </button>
                  </span>
                </div><!-- /input-group -->
                <input type="hidden" name="check_keywords" value="yes" />
                <input type="hidden" name="area" value="default" />
              </form>
            </li>
          </ul>
        </li>
        <!-- end search dropdown -->

        <li class="divider-vertical"></li>

        <!-- user account dropdown -->
        <li class="dropdown">
          <a class="dropdown-toggle" href="#" data-toggle="dropdown">
            <i class="glyphicon glyphicon-user" style="opacity:0.9;"></i>
          </a>
          <ul class="dropdown-menu user-menu">
            <li><span class='loggedinuser'></span></li>
            <li class="divider"></li>
            <li><a href='http://127.0.0.1:8000/runestone/admin/index'>Instructor's Page</a></li>
            <li class="divider"></li>
            <li><a href="http://127.0.0.1:8000/runestone/default/user/profile" id="profilelink">Edit Profile</a></li>
            <li><a href="http://127.0.0.1:8000/runestone/default/user/change_password" id="passwordlink">Change Password</a></li>
            <li><a href="http://127.0.0.1:8000/runestone/default/user/register" id="registerlink">Register</a></li>
            <li class='loginout'><a href='#'>Login</a></li> <!-- correct link populated by addNavbarLoginLink() -->
          </ul>
        </li>
        <!-- end user account dropdown -->

        <li class="divider-vertical"></li>

        <!-- help menu dropdown -->
        <li class="dropdown">
          <a class="dropdown-toggle" href="#" data-toggle="dropdown">
            <i class="glyphicon glyphicon-question-sign" style="opacity:0.9;"></i>
          </a>
          <ul class="dropdown-menu user-menu">
            <li><a href='/runestone/static/pythonds/navhelp.html'>Navigation Help</a></li>
            <li><a href='/runestone/static/overview/instructor.html'>Help for Instructors</a></li>
            <li class="divider"></li>
            <li><a href='http://runestoneinteractive.org'>About Runestone</a></li>
            <li><a href='https://github.com/bnmnetp/runestone/issues/new'>Report A Problem</a></li>
          </ul>
        </li>
        <!-- end help menu dropdown -->

        <li class="divider-vertical"></li>

      </ul>

      <ul class="nav navbar-nav">
        <li class="divider-vertical"></li>
        <!--
          <li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown">Page <b class="caret"></b></a>
  <ul class="dropdown-menu localtoc"><ul>
<li><a class="reference internal" href="#">Списки</a></li>
</ul>
</ul>
</li>
          <li class="divider-vertical"></li>
        
        
          
  <li id="relations-prev" title="Previous Chapter - Производительность структур данных в Python" data-toggle="tooltip">
    <a href="PerformanceofPythonDataStructures.html" >
      <i class='glyphicon glyphicon-backward' style='opacity:0.9;'></i>
    </a>
  </li>
  
  <li id="relations-next" title='Next Chapter - Словари' data-toggle="tooltip" >
    <a href="Dictionaries.html" >
      <i class='glyphicon glyphicon-forward' style='opacity:0.9;'></i>
    </a>
  </li>
  <li class="divider-vertical"></li>

<script type="text/javascript">
  opts = {'placement':'bottom',
          'selector': '',
          'delay': { show: 100, hide: 50}
         };

  $('#relations-prev').tooltip(opts);
  $('#relations-next').tooltip(opts);
</script>
        -->
        
          <li></li>
        
      </ul>

    </div>
  </div>
</div>


<div class="container" id="continue-reading"></div>

<div class="container" id="main-content">
  
  <div class="section" id="id1">
<h1>Списки<a class="headerlink" href="#id1" title="Permalink to this headline">¶</a></h1>
<p>Разработчики Python имели обширный выбор, когда реализовывали списки
как структуру данных. Каждое их решение оказывает влияние на скорость
выполнения операций со списками. Чтобы помочь себе принимать верные
решения, они смотрели на то, для чего пользователи используют списки
чаще всего, и они оптимизировали реализацию списков таким образом,
чтобы наиболее распространённые операции совершались очень быстро.
Конечно, они так же старались сделать быстрыми и менее используемые
операции, но при поиске компромиссов производительность менее
распространённых операций приносилась в жертву в пользу более
распространённых операций.</p>
<p>Двумя наиболее распространёнными операциями для списков являются индексация
и присваивание на заданную позицию. Обе они занимают равное количество
времени, вне зависимости от того, насколько велик список. Когда операции
не зависят от размера списка (как названные выше), говорят, что они имеют <span class="math">\(O(1)\)</span></p>
<p>Другим часто встречающимся программистским заданием является увеличение списка.
Существует два способа продлить список. Вы можете использовать метод добавления
или оператор конкатенации. Первый является <span class="math">\(O(1)\)</span>, но вот второй имеет
<span class="math">\(O(k)\)</span>, где <span class="math">\(k\)</span> - размер списка, который будет присоединён. Эта
информация полезна вам, потому что помогает сделать ваши программы более
эффективными, выбирая правильный инструмент для работы.</p>
<p>Давайте рассмотрим четыре разных способа сгенерировать список из <tt class="docutils literal"><span class="pre">n</span></tt> чисел,
начинающийся с нуля. Сначала мы попробуем цикл <tt class="docutils literal"><span class="pre">for</span></tt> и создадим список с помощью
конкатенации. Затем используем для этого метод <tt class="docutils literal"><span class="pre">append</span></tt>. Далее попытаемся создать
список, используя генераторы списков. И, наконец, используем для этого, возможно,
самый очевидный способ - функцию <tt class="docutils literal"><span class="pre">range</span></tt>, обёрнутую в конструктор списка.
<a class="reference internal" href="#lst-mklist"><em>Listing 3</em></a> показывает код для всех этих четырёх способов.</p>
<p id="lst-mklist"><strong>Листинг 3</strong></p>
<div class="highlight-python"><div class="highlight"><pre><span class="k">def</span> <span class="nf">test1</span><span class="p">():</span>
    <span class="n">l</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1000</span><span class="p">):</span>
        <span class="n">l</span> <span class="o">=</span> <span class="n">l</span> <span class="o">+</span> <span class="p">[</span><span class="n">i</span><span class="p">]</span>

<span class="k">def</span> <span class="nf">test2</span><span class="p">():</span>
    <span class="n">l</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1000</span><span class="p">):</span>
        <span class="n">l</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">test3</span><span class="p">():</span>
    <span class="n">l</span> <span class="o">=</span> <span class="p">[</span><span class="n">i</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1000</span><span class="p">)]</span>

<span class="k">def</span> <span class="nf">test4</span><span class="p">():</span>
    <span class="n">l</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">1000</span><span class="p">))</span>
</pre></div>
</div>
<p>Чтобы получить время, требуемое для выполнения каждой функции, мы используем
модуль Python <tt class="docutils literal"><span class="pre">timeit</span></tt>. Он разработан для того, чтобы разработчики на
Python могли делать кроссплатформенные синхронные измерения, запуская функции
в согласованной среде и используя механизмы синхронизации, максимально схожие
между собой для разных операционных систем.</p>
<p>Чтобы использовать <tt class="docutils literal"><span class="pre">timeit</span></tt>, вам нужно создать объект <tt class="docutils literal"><span class="pre">Timer</span></tt>, чьими
параметрами являются два положения на Python. Первый параметр - оператор
Python, говорящий, что вам нужно время; второй - утверждение, что тест будет
проводиться один раз. Модуль <tt class="docutils literal"><span class="pre">timeit</span></tt> будет несколько раз замерять время,
необходимое для выполнения операции. По умолчанию он пытается запустить
операцию один миллион раз. Когда это будет сделано, он вернёт время как
число с плавающей запятой, представляющее собой общее количество секунд.
Однако, поскольку он вычислял оператор миллион раз, то вы можете прочитать
результат, как количество микросекунд, затраченных на выполнение одного теста.
Так же можно передать в <tt class="docutils literal"><span class="pre">timeit</span></tt> именованный параметр <tt class="docutils literal"><span class="pre">number</span></tt>, который
позволит вам конкретизировать, сколько раз нужно запустить оператор. Следующий
фрагмент показывает, как долго занимает запуск каждой тестовой функции тысячу раз.</p>
<div class="highlight-python"><div class="highlight"><pre>t1 = Timer(&quot;test1()&quot;, &quot;from __main__ import test1&quot;)
print(&quot;concat &quot;,t1.timeit(number=1000), &quot;milliseconds&quot;)
t2 = Timer(&quot;test2()&quot;, &quot;from __main__ import test2&quot;)
print(&quot;append &quot;,t2.timeit(number=1000), &quot;milliseconds&quot;)
t3 = Timer(&quot;test3()&quot;, &quot;from __main__ import test3&quot;)
print(&quot;comprehension &quot;,t3.timeit(number=1000), &quot;milliseconds&quot;)
t4 = Timer(&quot;test4()&quot;, &quot;from __main__ import test4&quot;)
print(&quot;list range &quot;,t4.timeit(number=1000), &quot;milliseconds&quot;)

concat  6.54352807999 milliseconds
append  0.306292057037 milliseconds
comprehension  0.147661924362 milliseconds
list range  0.0655000209808 milliseconds
</pre></div>
</div>
<p>В эксперименте выше, операторами, для которых мы замеряли время, являются
функции <tt class="docutils literal"><span class="pre">test1()</span></tt>, <tt class="docutils literal"><span class="pre">test2()</span></tt> и так далее. Оператор начальной установки
может показать вам очень необычным, так что давайте разберём детали.
Возможно, вы хорошо знакомы с операторами <tt class="docutils literal"><span class="pre">from&lt;</span></tt> и <tt class="docutils literal"><span class="pre">import`</span></tt>, но они
обычно используются в начале файлов программ на Python. В нашем случае,
оператор <tt class="docutils literal"><span class="pre">from</span> <span class="pre">__main__</span> <span class="pre">import</span> <span class="pre">test1</span></tt> импортирует функцию <tt class="docutils literal"><span class="pre">test1</span></tt>
из пространства имён <tt class="docutils literal"><span class="pre">__main__</span></tt> в пространство имён, в котором <tt class="docutils literal"><span class="pre">timeit</span></tt>
ставит свой временнОй эксперимент. Он делает это потому, что хочет запускать
тесты в среде, где отсутствуют бродячие переменные, которые вы могли создать
и которые могут повлиять на производительность вашей функции непредвиденным образом.</p>
<p>Из эксперимента выше совершенно ясно, что операция <tt class="docutils literal"><span class="pre">append</span></tt> за 0.30
миллисекунд быстрее, чем конкатенация за 6.54 миллисекунды. Также мы
видим время, требуемое для двух дополнительных методов создания списков:
использования конструктора списка с вызовом <tt class="docutils literal"><span class="pre">range</span></tt> и генератора списков.
Интересно, что последний в два раза быстрее, чем цикл <tt class="docutils literal"><span class="pre">for</span></tt> с операцией
<tt class="docutils literal"><span class="pre">append</span></tt>.</p>
<p>Наше последнее наблюдение в этом маленьком эксперименте заключается в том,
что все времена, которые вы видите выше, содержат некоторые издержки при
фактическом вызове тестовой функции. Однако, мы можем предположить, что для
всех четырёх случаев эта величина одинакова, так что мы по-прежнему имеем
адекватное сравнение операций. Поэтому правильно говорить не &#8220;конкатенация
занимает 6.54 миллисекунды&#8221;, а &#8220;тестовая функция конкатенации выполняется
6.54 миллисекунд&#8221;. В качестве упражнения, вы можете провести временнОй тест
для пустой функции и вычесть его результат из чисел выше.</p>
<p>После того, как мы увидели, как конкретно может быть измерена производительность,
вы можете посмотреть в <a class="reference internal" href="#tbl-listbigo"><em>Таблицу 2</em></a>, чтобы узнать эффективность
в терминах &#8220;большого О&#8221; для основных операций над списками. После вдумчивого
размышления над ней, вы можете заинтересоваться двумя разными временами для <tt class="docutils literal"><span class="pre">pop</span></tt>.
Когда этот метод вызывается для конца списка, это занимает <span class="math">\(O(1)\)</span>. Но когда
<tt class="docutils literal"><span class="pre">pop</span></tt> вызывают для первого или любого другого элемента из середины списка, он имеет
<span class="math">\(O(n)\)</span>. Причина кроется в том, как в Python выбрана реализация списков. Когда
элемент берётся из начала списка, то все прочие элементы смещаются на одну позицию
вперёд. Сейчас это может показаться вам глупым, но если вы посмотрите на
<a class="reference internal" href="#tbl-listbigo"><em>Table 2</em></a>, то увидите, что эта же реализация позволяет операции
индексации иметь <span class="math">\(O(1)\)</span>. Это один из тех компромиссов, которые разработчики
Python сочли разумными.</p>
<table border="1" class="docutils" id="tbl-listbigo">
<caption><strong>Таблица 2: Эффективность операторов для списков в Python в терминах нотации &#8220;большое О&#8221;</strong></caption>
<colgroup>
<col width="55%" />
<col width="45%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Операция</th>
<th class="head">Эффективность</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>index []</td>
<td>O(1)</td>
</tr>
<tr class="row-odd"><td>Присваивание по индексу</td>
<td>O(1)</td>
</tr>
<tr class="row-even"><td>append</td>
<td>O(1)</td>
</tr>
<tr class="row-odd"><td>pop()</td>
<td>O(1)</td>
</tr>
<tr class="row-even"><td>pop(i)</td>
<td>O(n)</td>
</tr>
<tr class="row-odd"><td>insert(i,item)</td>
<td>O(n)</td>
</tr>
<tr class="row-even"><td>оператор del</td>
<td>O(n)</td>
</tr>
<tr class="row-odd"><td>итерирование</td>
<td>O(n)</td>
</tr>
<tr class="row-even"><td>вхождение (in)</td>
<td>O(n)</td>
</tr>
<tr class="row-odd"><td>срез [x:y]</td>
<td>O(k)</td>
</tr>
<tr class="row-even"><td>удалить срез</td>
<td>O(n)</td>
</tr>
<tr class="row-odd"><td>задать срез</td>
<td>O(n+k)</td>
</tr>
<tr class="row-even"><td>обратить</td>
<td>O(n)</td>
</tr>
<tr class="row-odd"><td>конкантенация</td>
<td>O(k)</td>
</tr>
<tr class="row-even"><td>сортировка</td>
<td>O(n log n)</td>
</tr>
<tr class="row-odd"><td>размножить</td>
<td>O(nk)</td>
</tr>
</tbody>
</table>
<p>В качестве способа демонстрации этих различий в производительности, давайте
проведём другой эксперимент с использованием модуля <tt class="docutils literal"><span class="pre">timeit</span></tt>. Нашей целью
будет возможность проверки производительности операции <tt class="docutils literal"><span class="pre">pop</span></tt> на списке
известного размера, когда программа выталкивает элемент из конца списка, и
ещё раз - когда программа вталкивает элемент из начала списка. Мы также
произведём замеры времени на списках разной длины. Что мы ожидаем увидеть,
так это то, что временнАя зависимость у выталкивания из конца списка остаётся
одинаковой при увеличении списка, в то время как выталкивание из начала списка
будет расти вместе со списковой длиной.</p>
<p><a class="reference internal" href="#lst-popmeas"><em>Листинг 10</em></a> демонстрирует одну попытку замерить разницу
между двумя использованиями &lt;code&gt;pop&lt;/code&gt;. Как видно из первого примера,
выталкивание с конца занимает 0.0003 миллисекунды, в то время как на выталкивание
из начала требуется 4.82 миллисекунды. Для списка в два миллиона элементов
коэффициент будет 16 000</p>
<p>Есть ещё несколько замечаний относительно <a class="reference internal" href="#lst-popmeas"><em>Листинг 4</em></a>.
Первое - это оператор <tt class="docutils literal"><span class="pre">from</span> <span class="pre">__main__</span> <span class="pre">import</span> <span class="pre">x</span></tt>. Несмотря на то, что мы не
определяли функцию, мы хотим иметь возможность использовать список-объект
<tt class="docutils literal"><span class="pre">x</span></tt> в нашем тесте. Этот подход позволяет нам замерять время только для
единственной <tt class="docutils literal"><span class="pre">pop</span></tt>-операции и получать для неё наиболее точное значение
времени. Поскольку замеры повторяются тысячу раз, то также важно отметить,
что список уменьшается в размерах на единицу за каждую итерацию.
Но поскольку изначально в нём два миллиона элементов, то общий объём уменьшится
примерно на <span class="math">\(0.05\%\)</span></p>
<p id="lst-popmeas"><strong>Листинг 4</strong></p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">popzero</span> <span class="o">=</span> <span class="n">timeit</span><span class="o">.</span><span class="n">Timer</span><span class="p">(</span><span class="s">&quot;x.pop(0)&quot;</span><span class="p">,</span>
                       <span class="s">&quot;from __main__ import x&quot;</span><span class="p">)</span>
<span class="n">popend</span> <span class="o">=</span> <span class="n">timeit</span><span class="o">.</span><span class="n">Timer</span><span class="p">(</span><span class="s">&quot;x.pop()&quot;</span><span class="p">,</span>
                      <span class="s">&quot;from __main__ import x&quot;</span><span class="p">)</span>

<span class="n">x</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">2000000</span><span class="p">))</span>
<span class="n">popzero</span><span class="o">.</span><span class="n">timeit</span><span class="p">(</span><span class="n">number</span><span class="o">=</span><span class="mi">1000</span><span class="p">)</span>
<span class="mf">4.8213560581207275</span>

<span class="n">x</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">2000000</span><span class="p">))</span>
<span class="n">popend</span><span class="o">.</span><span class="n">timeit</span><span class="p">(</span><span class="n">number</span><span class="o">=</span><span class="mi">1000</span><span class="p">)</span>
<span class="mf">0.0003161430358886719</span>
</pre></div>
</div>
<p>Пока наш первый тест показывает, что <tt class="docutils literal"><span class="pre">pop(0)</span></tt> действительно медленнее
<tt class="docutils literal"><span class="pre">pop()</span></tt>. Но он не подтверждает заявление, что <tt class="docutils literal"><span class="pre">pop(0)</span></tt> является
<span class="math">\(O(n)\)</span>, в то время как <tt class="docutils literal"><span class="pre">pop()</span></tt> - <span class="math">\(O(1)\)</span>. Чтобы доказать это,
нам нужно рассмотреть производительность обоих вызовов на диапазоне размеров
списков. <a class="reference internal" href="#lst-poplists"><em>Листинг 5</em></a> реализует этот тест.</p>
<p id="lst-poplists"><strong>Листинг 5</strong></p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">popzero</span> <span class="o">=</span> <span class="n">Timer</span><span class="p">(</span><span class="s">&quot;x.pop(0)&quot;</span><span class="p">,</span>
                <span class="s">&quot;from __main__ import x&quot;</span><span class="p">)</span>
<span class="n">popend</span> <span class="o">=</span> <span class="n">Timer</span><span class="p">(</span><span class="s">&quot;x.pop()&quot;</span><span class="p">,</span>
               <span class="s">&quot;from __main__ import x&quot;</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="s">&quot;pop(0)   pop()&quot;</span><span class="p">)</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1000000</span><span class="p">,</span><span class="mi">100000001</span><span class="p">,</span><span class="mi">1000000</span><span class="p">):</span>
    <span class="n">x</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="n">i</span><span class="p">))</span>
    <span class="n">pt</span> <span class="o">=</span> <span class="n">popend</span><span class="o">.</span><span class="n">timeit</span><span class="p">(</span><span class="n">number</span><span class="o">=</span><span class="mi">1000</span><span class="p">)</span>
    <span class="n">x</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="n">i</span><span class="p">))</span>
    <span class="n">pz</span> <span class="o">=</span> <span class="n">popzero</span><span class="o">.</span><span class="n">timeit</span><span class="p">(</span><span class="n">number</span><span class="o">=</span><span class="mi">1000</span><span class="p">)</span>
    <span class="k">print</span><span class="p">(</span><span class="s">&quot;</span><span class="si">%15.5f</span><span class="s">, </span><span class="si">%15.5f</span><span class="s">&quot;</span> <span class="o">%</span><span class="p">(</span><span class="n">pz</span><span class="p">,</span><span class="n">pt</span><span class="p">))</span>
</pre></div>
</div>
<p>На <a class="reference internal" href="#fig-poptest"><em>Рисунке 3</em></a> показаны результаты нашего эксперимента.
Вы можете видеть, как список делается всё длиннее и длиннее, и время,
необходимое для <tt class="docutils literal"><span class="pre">pop(0)</span></tt> тоже увеличивается, тогда как график для <tt class="docutils literal"><span class="pre">pop</span></tt>
остаётся плоским. Это в точности то, что мы ожидали увидеть от алгоритмов с
<span class="math">\(O(n)\)</span> и <span class="math">\(O(1)\)</span></p>
<p>Некоторым источником ошибок в нашем маленьком эксперименте стал тот факт,
что на компьютере запущены и другие процессы, которые могут замедлять наш
код. Несмотря на то, что мы старались минимизировать влияние прочих
происходящих на компьютере вещей, с ними связаны некоторые флуктуации
времён. Именно поэтому цикл выполняет тест тысячу - в первую очередь,
чтобы статистически собрать достаточно информации для утверждения о
надёжности измерений.</p>
<div class="figure" id="fig-poptest">
<img alt="../_images/poptime.png" src="../_images/poptime.png" />
<p class="caption">Рисунок 3: Сравнение производительности <tt class="docutils literal"><span class="pre">pop</span></tt> и <tt class="docutils literal"><span class="pre">pop(0)</span></tt></p>
</div>
</div>


  
      
  <li id="relations-prev" class="navLink" title='Previous Section - Производительность структур данных в Python' data-toggle="tooltip">
    <a href="PerformanceofPythonDataStructures.html" >
      <i class='prevNav glyphicon glyphicon-chevron-left'></i>
    </a>
  </li>
  <a class="navLinkBg" id="navLinkBgLeft"  href="PerformanceofPythonDataStructures.html" ></a>
  
  <li id="relations-next" class="navLink" title='Next Section - Словари' data-toggle="tooltip" >
    <a href="Dictionaries.html" >
      <i id="relationsNextIcon" class='nextNav glyphicon glyphicon-chevron-right'></i>
    </a>
  </li>
  <a class="navLinkBg navLink" id="navLinkBgRight" href="Dictionaries.html" >Next Section - Словари</a>

<script type="text/javascript">

  $('#relations-prev').tooltip({'placement':'right', 'selector': '', 'delay': { show: 100, hide: 50}});
  $('#relations-next').tooltip({'placement':'left', 'selector': '', 'delay': { show: 100, hide: 50}});
  
</script>
  
</div>
<footer class="footer">
  <div class="container">
    <p class="pull-right">
      <span id='numuserspan'></span> readers online now | <span class='loggedinuser'></span> | <a href="#">Back to top</a>
      
    </p>
    <p>
        &copy; Copyright 2013 Brad Miller, David Ranum.
      Created using <a href="http://sphinx.pocoo.org/">Sphinx</a> 1.2.2.
    </p>
  </div>
</footer>

<script type="text/javascript" charset="utf-8">
    $(document).ready(addUserToFooter);
    $(document).ready(addNavbarLoginLink);
    $(document).ready(createEditors);
    $(document).ready(getNumUsers);
    $(document).ready(getOnlineUsers);
    $(document).ready(createScratchActivecode());
    $(document).ready(styleUnittestResults());
</script>

<script type="text/javascript">
  // add the video play button overlay image
  $(".video-play-overlay").each(function() {
    $(this).css('background-image', "url(\'../_static/play_overlay_icon.png\')")
    });

  // This function is needed to allow the dropdown search bar to work;
  // The default behaviour is that the dropdown menu closes when something in
  // it (like the search bar) is clicked
  $(function() {
    // Fix input element click problem
    $('.dropdown input, .dropdown label').click(function(e) {
      e.stopPropagation();
      });
  });

  // style codelens buttons (doing it here because PyTutor is a submodule owned by someone else
  $(function() {
    $(".ExecutionVisualizer").each(function() {
      $(this).find("#jmpFirstInstr").addClass('btn btn-default');
      $(this).find("#jmpStepBack").addClass('btn btn-danger');
      $(this).find("#jmpStepFwd").addClass('btn btn-success');
      $(this).find("#jmpLastInstr").addClass('btn btn-default');
      });
  });

</script>


<script type="text/javascript">
  var _gaq = _gaq || [];
  _gaq.push(['_setAccount', 'UA-32029811-1']);
  _gaq.push(['_trackPageview']);

  (function() {
    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
  })();
</script>



  </body>
</html>